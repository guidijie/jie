<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jie.stupiddog.dao.GoodsAndImagesDao">

    <!--查询所有商品信息-->
    <select id="findAll" resultType="GoodsAndImages">
        SELECT
			g.id,
			g.`name`,
			g.price,
			g.preferential,
			g.introduction,
			img.path
		FROM
			t_goods g,
			t_goods_images img
		WHERE
			g.id = img.goods_id
    </select>


    <!--查询所有商品信息-->
    <select id="findGoodsId" resultType="GoodsAndImages" parameterType="Integer">
        SELECT
			g.id,
			g.`name`,
			g.price,
			g.preferential,
			g.grade,
			g.introduction,
			g.details,
			g.`directory`,
			img.path,
			gt.type_name
		FROM
			t_goods g,
			t_goods_images img,
			t_goods_type gt,
			t_goods_id_type git
		WHERE
			g.id = #{id}
			AND g.id = img.goods_id
			AND gt.id = git.goods_type_id
			AND git.goods_id = g.id

    </select>

    <!-- 查询难度级别 -->
    <select id="findGrade" resultType="GoodsAndImages" parameterType="String">
		SELECT
			g.id,
			g.`name`,
			g.price,
			g.preferential,
			g.grade,
			g.introduction,
			img.path
		FROM
			t_goods g,
			t_goods_images img
		WHERE
			g.id = img.goods_id
		AND g.grade = #{level}
	</select>

    <!-- 综合条件查询 -->
    <select id="findIfGoodsVo" resultType="GoodsAndImages" parameterType="com.jie.stupiddog.vo.GoodsVo">
        SELECT
        g.id,
        g.`name`,
        g.price,
        g.preferential,
        g.grade,
        g.introduction,
        img.path
        FROM
        t_goods g,
        t_goods_images img,
        t_goods_type gt,
        t_goods_id_type git
        WHERE
        g.id = img.goods_id
        AND gt.id = git.goods_type_id
        AND git.goods_id = g.id
        <if test="goodsType != null and goodsType != '' and goodsType != 'all' ">
            and gt.type_name = #{goodsType}
        </if>
        <if test="level != null and  level!= '' and level != 'all' ">
            and g.grade = #{level}
        </if>
    </select>

    <!-- 查询购物车的商品 -->
    <select id="findByGoodsID" parameterType="Integer" resultType="GoodsAndImages">
		SELECT
			gi.path,
			g.id,
			g.NAME,
			g.price,
			g.preferential
		FROM
			t_goods_images AS gi,
			t_goods AS g
		WHERE
			g.id = #{goodsId}
			AND gi.goods_id = g.id
	</select>
</mapper>